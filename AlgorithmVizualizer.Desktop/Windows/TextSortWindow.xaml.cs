using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using SortingText;

namespace AlgorithmVizualizer.Desktop.Windows
{
    /// <summary>
    /// Interaction logic for TextSortWindow.xaml
    /// </summary>
    public partial class TextSortWindow : Window
    {
        public TextSortWindow()
        {
            InitializeComponent();
            AlgComboBox.SelectedIndex = 0;
            TextBox.Text =
                "Mr and Mrs Dursley, of number four, Privet Drive, were proud to\nsay that they were perfectly normal, thank you very much. They\nwere the last people you’d expect to be involved in anything\nstrange or mysterious, because they just didn’t hold with such\nnonsense.\nMr Dursley was the director of a firm called Grunnings, which\nmade drills. He was a big, beefy man with hardly any neck,\nalthough he did have a very large moustache. Mrs Dursley was\nthin and blonde and had nearly twice the usual amount of neck,\nwhich came in very useful as she spent so much of her time craning\nover garden fences, spying on the neighbours. The Dursleys had a\nsmall son called Dudley and in their opinion there was no finer\nboy anywhere.\nThe Dursleys had everything they wanted, but they also had a\nsecret, and their greatest fear was that somebody would discover\nit. They didn’t think they could bear it if anyone found out about\nthe Potters. Mrs Potter was Mrs Dursley’s sister, but they hadn’t\nmet for several years; in fact, Mrs Dursley pretended she didn’t\nhave a sister, because her sister and her good-for-nothing husband\nwere as unDursleyish as it was possible to be. The Dursleys\nshuddered to think what the neighbours would say if the Potters\narrived in the street. The Dursleys knew that the Potters had a\nsmall son, too, but they had never even seen him. This boy was\nanother good reason for keeping the Potters away; they didn’t\nwant Dudley mixing with a child like that.\nWhen Mr and Mrs Dursley woke up on the dull, grey Tuesday\nour story starts, there was nothing about the cloudy sky outside to\nsuggest that strange and mysterious things would soon be happening all over the country. Mr Dursley hummed as he picked out\nhis most boring tie for work and Mrs Dursley gossiped away\n8 HARRY POTTER\nhappily as she wrestled a screaming Dudley into his high chair.\nNone of them noticed a large tawny owl flutter past the window.\nAt half past eight, Mr Dursley picked up his briefcase, pecked\nMrs Dursley on the cheek and tried to kiss Dudley goodbye but\nmissed, because Dudley was now having a tantrum and throwing\nhis cereal at the walls. ‘Little tyke,’ chortled Mr Dursley as he left\nthe house. He got into his car and backed out of number four’s\ndrive.\nIt was on the corner of the street that he noticed the first sign\nof something peculiar – a cat reading a map. For a second, Mr\nDursley didn’t realise what he had seen – then he jerked his head\naround to look again. There was a tabby cat standing on the corner\nof Privet Drive, but there wasn’t a map in sight. What could\nhe have been thinking of? It must have been a trick of the light.\nMr Dursley blinked and stared at the cat. It stared back. As Mr\nDursley drove around the corner and up the road, he watched the\ncat in his mirror. It was now reading the sign that said Privet Drive\n– no, looking at the sign; cats couldn’t read maps or signs. Mr\nDursley gave himself a little shake and put the cat out of his\nmind. As he drove towards town he thought of nothing except a\nlarge order of drills he was hoping to get that day.\nBut on the edge of town, drills were driven out of his mind by\nsomething else. As he sat in the usual morning traffic jam, he\ncouldn’t help noticing that there seemed to be a lot of strangely\ndressed people about. People in cloaks. Mr Dursley couldn’t bear\npeople who dressed in funny clothes – the get-ups you saw on\nyoung people! He supposed this was some stupid new fashion. He\ndrummed his fingers on the steering wheel and his eyes fell on a\nhuddle of these weirdos standing quite close by. They were whispering excitedly together. Mr Dursley was enraged to see that a\ncouple of them weren’t young at all; why, that man had to be older\nthan he was, and wearing an emerald-green cloak! The nerve of\nhim! But then it struck Mr Dursley that this was probably some\nsilly stunt – these people were obviously collecting for something\n... yes, that would be it. The traffic moved on, and a few minutes\nlater, Mr Dursley arrived in the Grunnings car park, his mind\nback on drills.\nMr Dursley always sat with his back to the window in his office\non the ninth floor. If he hadn’t, he might have found it harder to\nconcentrate on drills that morning. He didn’t see the owls\n THE BOY WHO LIVED 9\nswooping past in broad daylight, though people down in the\nstreet did; they pointed and gazed open-mouthed as owl after owl\nsped overhead. Most of them had never seen an owl even at nighttime. Mr Dursley, however, had a perfectly normal, owl-free morning. He yelled at five different people. He made several important\ntelephone calls and shouted a bit more. He was in a very good\nmood until lunch-time, when he thought he’d stretch his legs\nand walk across the road to buy himself a bun from the baker’s\nopposite.\nHe’d forgotten all about the people in cloaks until he passed a\ngroup of them next to the baker’s. He eyed them angrily as he\npassed. He didn’t know why, but they made him uneasy. This lot\nwere whispering excitedly, too, and he couldn’t see a single\ncollecting tin. It was on his way back past them, clutching a large\ndoughnut in a bag, that he caught a few words of what they were\nsaying.\n‘The Potters, that’s right, that’s what I heard –’\n‘– yes, their son, Harry –’\nMr Dursley stopped dead. Fear flooded him. He looked back at\nthe whisperers as if he wanted to say something to them, but\nthought better of it.\nHe dashed back across the road, hurried up to his office,\nsnapped at his secretary not to disturb him, seized his telephone\nand had almost finished dialling his home number when he\nchanged his mind. He put the receiver back down and stroked his\nmoustache, thinking ... no, he was being stupid. Potter wasn’t\nsuch an unusual name. He was sure there were lots of people\ncalled Potter who had a son called Harry. Come to think of it, he\nwasn’t even sure his nephew was called Harry. He’d never even\nseen the boy. It might have been Harvey. Or Harold. There was no\npoint in worrying Mrs Dursley, she always got so upset at any\nmention of her sister. He didn’t blame her – if he’d had a sister like\nthat ... but all the same, those people in cloaks ...\nHe found it a lot harder to concentrate on drills that afternoon,\nand when he left the building at five o’clock, he was still so\nworried that he walked straight into someone just outside the door.\n‘Sorry,’ he grunted, as the tiny old man stumbled and almost\nfell. It was a few seconds before Mr Dursley realised that the man\nwas wearing a violet cloak. He didn’t seem at all upset at being\nalmost knocked to the ground. On the contrary, his face split into\n10 HARRY POTTER\na wide smile and he said in a squeaky voice that made passers-by\nstare: ‘Don’t be sorry, my dear sir, for nothing could upset me\ntoday! Rejoice, for You-Know-Who has gone at last! Even\nMuggles like yourself should be celebrating, this happy happy\nday!’\nAnd the old man hugged Mr Dursley around the middle and\nwalked off.\nMr Dursley stood rooted to the spot. He had been hugged by a\ncomplete stranger. He also thought he had been called a Muggle,\nwhatever that was. He was rattled. He hurried to his car and set\noff home, hoping he was imagining things, which he had never\nhoped before, because he didn’t approve of imagination.\nAs he pulled into the driveway of number four, the first thing he\nsaw – and it didn’t improve his mood – was the tabby cat he’d\nspotted that morning. It was now sitting on his garden wall. He was\nsure it was the same one; it had the same markings around its eyes.\n‘Shoo!’ said Mr Dursley loudly.\nThe cat didn’t move. It just gave him a stern look. Was this normal cat behaviour, Mr Dursley wondered. Trying to pull himself\ntogether, he let himself into the house. He was still determined\nnot to mention anything to his wife.\nMrs Dursley had had a nice, normal day. She told him over dinner all about Mrs Next Door’s problems with her daughter and\nhow Dudley had learnt a new word (‘Shan’t!’). Mr Dursley tried to\nact normally. When Dudley had been put to bed, he went into the\nliving-room in time to catch the last report on the evening news:\nAnd finally, bird-watchers everywhere have reported that the\nnation’s owls have been behaving very unusually today. Although\nowls normally hunt at night and are hardly ever seen in daylight,\nthere have been hundreds of sightings of these birds flying in\nevery direction since sunrise. Experts are unable to explain why\nthe owls have suddenly changed their sleeping pattern.’ The news\nreader allowed himself a grin. ‘Most mysterious. And now, over to\nJim McGuffin with the weather. Going to be any more showers of\nowls tonight, Jim?’\n‘Well, Ted,’ said the weatherman, ‘I don’t know about that, but\nit’s not only the owls that have been acting oddly today. Viewers as\nfar apart as Kent, Yorkshire and Dundee have been phoning in\nto tell me that instead of the rain I promised yesterday, they’ve\nhad a downpour of shooting stars! Perhaps people have been\n THE BOY WHO LIVED 11\ncelebrating Bonfire Night early – it’s not until next week, folks!\nBut I can promise a wet night tonight.’\nMr Dursley sat frozen in his armchair. Shooting stars all over\nBritain? Owls flying by daylight? Mysterious people in cloaks all\nover the place? And a whisper, a whisper about the Potters ...\nMrs Dursley came into the living-room carrying two cups of\ntea. It was no good. He’d have to say something to her. He cleared\nhis throat nervously. ‘Er – Petunia, dear – you haven’t heard from\nyour sister lately, have you?’\nAs he had expected, Mrs Dursley looked shocked and angry.\nAfter all, they normally pretended she didn’t have a sister.\n‘No,’ she said sharply. ‘Why?’\n‘Funny stuff on the news,’ Mr Dursley mumbled. ‘Owls ...\nshooting stars ... and there were a lot of funny-looking people in\ntown today ...’\n‘So?’ snapped Mrs Dursley.\n‘Well, I just thought ... maybe ... it was something to do with ...\nyou know ... her lot.’\nMrs Dursley sipped her tea through pursed lips. Mr Dursley\nwondered whether he dared tell her he’d heard the name ‘Potter’.\nHe decided he didn’t dare. Instead he said, as casually as he could,\n‘Their son – he’d be about Dudley’s age now, wouldn’t he?’\n‘I suppose so,’ said Mrs Dursley stiffly.\n‘What’s his name again? Howard, isn’t it?’\n‘Harry. Nasty, common name, if you ask me.’\n‘Oh, yes,’ said Mr Dursley, his heart sinking horribly. ‘Yes, I\nquite agree.’\nHe didn’t say another word on the subject as they went upstairs\nto bed. While Mrs Dursley was in the bathroom, Mr Dursley crept\nto the bedroom window and peered down into the front garden.\nThe cat was still there. It was staring down Privet Drive as though\nit was waiting for something.\nWas he imagining things? Could all this have anything to do\nwith the Potters? If it did ... if it got out that they were related to a\npair of – well, he didn’t think he could bear it.\nThe Dursleys got into bed. Mrs Dursley fell asleep quickly but\nMr Dursley lay awake, turning it all over in his mind. His last,\ncomforting thought before he fell asleep was that even if the\nPotters were involved, there was no reason for them to come near\nhim and Mrs Dursley. The Potters knew very well what he and\n12 HARRY POTTER\nPetunia thought about them and their kind ... He couldn’t see how\nhe and Petunia could get mixed up in anything that might be\ngoing on. He yawned and turned over. It couldn’t affect them ...\nHow very wrong he was.\nMr Dursley might have been drifting into an uneasy sleep, but\nthe cat on the wall outside was showing no sign of sleepiness. It\nwas sitting as still as a statue, its eyes fixed unblinkingly on the\nfar corner of Privet Drive. It didn’t so much as quiver when a car\ndoor slammed in the next street, nor when two owls swooped\noverhead. In fact, it was nearly midnight before the cat moved at all.\nA man appeared on the corner the cat had been watching,\nappeared so suddenly and silently you’d have thought he’d just\npopped out of the ground. The cat’s tail twitched and its eyes\nnarrowed.\nNothing like this man had ever been seen in Privet Drive. He\nwas tall, thin and very old, judging by the silver of his hair and\nbeard, which were both long enough to tuck into his belt. He was\nwearing long robes, a purple cloak which swept the ground and\nhigh-heeled, buckled boots. His blue eyes were light, bright and\nsparkling behind half-moon spectacles and his nose was very long\nand crooked, as though it had been broken at least twice. This\nman’s name was Albus Dumbledore.\nAlbus Dumbledore didn’t seem to realise that he had just\narrived in a street where everything from his name to his boots\nwas unwelcome. He was busy rummaging in his cloak, looking for\nsomething. But he did seem to realise he was being watched,\nbecause he looked up suddenly at the cat, which was still staring\nat him from the other end of the street. For some reason, the sight\nof the cat seemed to amuse him. He chuckled and muttered, ‘I\nshould have known.’\nHe had found what he was looking for in his inside pocket. It\nseemed to be a silver cigarette lighter. He flicked it open, held it\nup in the air and clicked it. The nearest street lamp went out with\na little pop. He clicked it again – the next lamp flickered into\ndarkness. Twelve times he clicked the Put-Outer, until the only\nlights left in the whole street were two tiny pinpricks in the distance, which were the eyes of the cat watching him. If anyone\nlooked out of their window now, even beady-eyed Mrs Dursley,\nthey wouldn’t be able to see anything that was happening down\non the pavement. Dumbledore slipped the Put-Outer back inside\n THE BOY WHO LIVED 13\nhis cloak and set off down the street towards number four, where\nhe sat down on the wall next to the cat. He didn’t look at it, but\nafter a moment he spoke to it.\n‘Fancy seeing you here, Professor McGonagall.’\nHe turned to smile at the tabby, but it had gone. Instead he was\nsmiling at a rather severe-looking woman who was wearing square\nglasses exactly the shape of the markings the cat had had around\nits eyes. She, too, was wearing a cloak, an emerald one. Her black\nhair was drawn into a tight bun. She looked distinctly ruffled.\n‘How did you know it was me?’ she asked.\n‘My dear Professor, I’ve never seen a cat sit so stiffly.’\n‘You’d be stiff if you’d been sitting on a brick wall all day,’ said\nProfessor McGonagall.\n‘All day? When you could have been celebrating? I must have\npassed a dozen feasts and parties on my way here.’\nProfessor McGonagall sniffed angrily.\n‘Oh yes, everyone’s celebrating, all right,’ she said impatiently.\n‘You’d think they’d be a bit more careful, but no – even the\nMuggles have noticed something’s going on. It was on their news.’\nShe jerked her head back at the Dursleys’ dark living-room\nwindow. ‘I heard it. Flocks of owls ... shooting stars ... Well,\nthey’re not completely stupid. They were bound to notice\nsomething. Shooting stars down in Kent – I’ll bet that was Dedalus\nDiggle. He never had much sense.’\n‘You can’t blame them,’ said Dumbledore gently. ‘We’ve had\nprecious little to celebrate for eleven years.’\n‘I know that,’ said Professor McGonagall irritably. ‘But that’s no\nreason to lose our heads. People are being downright careless, out\non the streets in broad daylight, not even dressed in Muggle\nclothes, swapping rumours.’\nShe threw a sharp, sideways glance at Dumbledore here, as\nthough hoping he was going to tell her something, but he didn’t,\nso she went on: ‘A fine thing it would be if, on the very day YouKnow-Who seems to have disappeared at last, the Muggles found\nout about us all. I suppose he really has gone, Dumbledore?’\n‘It certainly seems so,’ said Dumbledore. ‘We have much to be\nthankful for. Would you care for a sherbet lemon?’\n‘A what?’\n‘A sherbet lemon. They’re a kind of Muggle sweet I’m rather\nfond of.’\n14 HARRY POTTER\n‘No, thank you,’ said Professor McGonagall coldly, as though\nshe didn’t think this was the moment for sherbet lemons. ‘As I say,\neven if You-Know-Who has gone –’\n‘My dear Professor, surely a sensible person like yourself can\ncall him by his name? All this “You-Know-Who” nonsense – for\neleven years I have been trying to persuade people to call him by\nhis proper name: Voldemort.’ Professor McGonagall flinched, but\nDumbledore, who was unsticking two sherbet lemons, seemed\nnot to notice. ‘It all gets so confusing if we keep saying “YouKnow-Who”.’ I have never seen any reason to be frightened of\nsaying Voldemort’s name.’\n‘I know you haven’t,’ said Professor McGonagall, sounding halfexasperated, half-admiring. ‘But you’re different. Everyone knows\nyou’re the only one You-Know – oh, all right, Voldemort – was\nfrightened of.’\n‘You flatter me,’ said Dumbledore calmly. ‘Voldemort had\npowers I will never have.’\n‘Only because you’re too – well – noble to use them.’\n‘It’s lucky it’s dark. I haven’t blushed so much since Madam\nPomfrey told me she liked my new earmuffs.’\nProfessor McGonagall shot a sharp look at Dumbledore and\nsaid, ‘The owls are nothing to the rumours that are flying around.\nYou know what everyone’s saying? About why he’s disappeared?\nAbout what finally stopped him?’\nIt seemed that Professor McGonagall had reached the point she\nwas most anxious to discuss, the real reason she had been waiting\non a cold hard wall all day, for neither as a cat nor as a woman\nhad she fixed Dumbledore with such a piercing stare as she did\nnow. It was plain that whatever ‘everyone’ was saying, she was not\ngoing to believe it until Dumbledore told her it was true.\nDumbledore, however, was choosing another sherbet lemon and\ndid not answer.\n‘What they’re saying,’ she pressed on, ‘is that last night Voldemort\nturned up in Godric’s Hollow. He went to find the Potters. The\nrumour is that Lily and James Potter are – are – that they’re –\ndead.’\nDumbledore bowed his head. Professor McGonagall gasped.\n‘Lily and James ... I can’t believe it ... I didn’t want to believe it\n... Oh, Albus ...’\nDumbledore reached out and patted her on the shoulder. ‘I\n THE BOY WHO LIVED 15\nknow ... I know ...’ he said heavily.\nProfessor McGonagall’s voice trembled as she went on. ‘That’s\nnot all. They’re saying he tried to kill the Potters’ son, Harry. But –\nhe couldn’t. He couldn’t kill that little boy. No one knows why, or\nhow, but they’re saying that when he couldn’t kill Harry Potter,\nVoldemort’s power somehow broke – and that’s why he’s gone.’\nDumbledore nodded glumly.\n‘It’s – it’s true?’ faltered Professor McGonagall. ‘After all he’s\ndone ... all the people he’s killed ... he couldn’t kill a little boy? It’s\njust astounding ... of all the things to stop him ... but how in the\nname of heaven did Harry survive?’\n‘We can only guess,’ said Dumbledore. ‘We may never know.’\nProfessor McGonagall pulled out a lace handkerchief and\ndabbed at her eyes beneath her spectacles. Dumbledore gave a\ngreat sniff as he took a golden watch from his pocket and examined\nit. It was a very odd watch. It had twelve hands but no numbers;\ninstead, little planets were moving around the edge. It must have\nmade sense to Dumbledore, though, because he put it back in his\npocket and said, ‘Hagrid’s late. I suppose it was he who told you\nI’d be here, by the way?’\n‘Yes,’ said Professor McGonagall. ‘And I don’t suppose you’re\ngoing to tell me why you’re here, of all places?’\n‘I’ve come to bring Harry to his aunt and uncle. They’re the\nonly family he has left now.’\n‘You don’t mean – you can’t mean the people who live here?’\ncried Professor McGonagall, jumping to her feet and pointing at\nnumber four. ‘Dumbledore – you can’t. I’ve been watching them\nall day. You couldn’t find two people who are less like us. And\nthey’ve got this son – I saw him kicking his mother all the way up\nthe street, screaming for sweets. Harry Potter come and live here!’\n‘It’s the best place for him,’ said Dumbledore firmly. ‘His aunt\nand uncle will be able to explain everything to him when he’s\nolder. I’ve written them a letter.’\n‘A letter?’ repeated Professor McGonagall faintly, sitting back\ndown on the wall. ‘Really, Dumbledore, you think you can explain\nall this in a letter? These people will never understand him! He’ll\nbe famous – a legend – I wouldn’t be surprised if today was\nknown as Harry Potter Day in future – there will be books written\nabout Harry – every child in our world will know his name!’\n‘Exactly,’ said Dumbledore, looking very seriously over the top\n16 HARRY POTTER\nof his half-moon glasses. ‘It would be enough to turn any boy’s\nhead. Famous before he can walk and talk! Famous for something\nhe won’t even remember! Can’t you see how much better off he’ll\nbe, growing up away from all that until he’s ready to take it?’\nProfessor McGonagall opened her mouth, changed her mind,\nswallowed and then said, ‘Yes – yes, you’re right, of course. But\nhow is the boy getting here, Dumbledore?’ She eyed his cloak\nsuddenly as though she thought he might be hiding Harry\nunderneath it.\n‘Hagrid’s bringing him.’\n‘You think it – wise – to trust Hagrid with something as important as this?’\n‘I would trust Hagrid with my life,’ said Dumbledore.\n‘I’m not saying his heart isn’t in the right place,’ said Professor\nMcGonagall grudgingly, ‘but you can’t pretend he’s not careless.\nHe does tend to – what was that?’\nA low rumbling sound had broken the silence around them. It\ngrew steadily louder as they looked up and down the street for\nsome sign of a headlight; it swelled to a roar as they both looked\nup at the sky – and a huge motorbike fell out of the air and landed\non the road in front of them.\nIf the motorbike was huge, it was nothing to the man sitting\nastride it. He was almost twice as tall as a normal man and at least\nfive times as wide. He looked simply too big to be allowed, and so\nwild – long tangles of bushy black hair and beard hid most of his\nface, he had hands the size of dustbin lids and his feet in their\nleather boots were like baby dolphins. In his vast, muscular arms\nhe was holding a bundle of blankets.\n‘Hagrid,’ said Dumbledore, sounding relieved. ‘At last. And\nwhere did you get that motorbike?’\n‘Borrowed it, Professor Dumbledore, sir,’ said the giant, climbing\ncarefully off the motorbike as he spoke. ‘Young Sirius Black lent it\nme. I’ve got him, sir.’\n‘No problems, were there?’\n‘No, sir – house was almost destroyed but I got him out all\nright before the Muggles started swarmin’ around. He fell asleep\nas we was flyin’ over Bristol.’\nDumbledore and Professor McGonagall bent forward over the\nbundle of blankets. Inside, just visible, was a baby boy, fast asleep.\nUnder a tuft of jet-black hair over his forehead they could see a\n THE BOY WHO LIVED 17\ncuriously shaped cut, like a bolt of lightning.\n‘Is that where –?’ whispered Professor McGonagall.\n‘Yes,’ said Dumbledore. ‘He’ll have that scar for ever.’\n‘Couldn’t you do something about it, Dumbledore?’\n‘Even if I could, I wouldn’t. Scars can come in useful. I have\none myself above my left knee which is a perfect map of the\nLondon Underground. Well – give him here, Hagrid – we’d better\nget this over with.’\nDumbledore took Harry in his arms and turned towards the\nDursleys’ house.\n‘Could I – could I say goodbye to him, sir?’ asked Hagrid.\nHe bent his great, shaggy head over Harry and gave him what\nmust have been a very scratchy, whiskery kiss. Then, suddenly,\nHagrid let out a howl like a wounded dog.\n‘Shhh!’ hissed Professor McGonagall. ‘You’ll wake the Muggles!’\n‘S-s-sorry,’ sobbed Hagrid, taking out a large spotted handkerchief and burying his face in it. ‘But I c-c-can’t stand it – Lily an’\nJames dead – an’ poor little Harry off ter live with Muggles –’\n‘Yes, yes, it’s all very sad, but get a grip on yourself, Hagrid, or\nwe’ll be found,’ Professor McGonagall whispered, patting Hagrid\ngingerly on the arm as Dumbledore stepped over the low garden\nwall and walked to the front door. He laid Harry gently on the\ndoorstep, took a letter out of his cloak, tucked it inside Harry’s\nblankets and then came back to the other two. For a full minute\nthe three of them stood and looked at the little bundle; Hagrid’s\nshoulders shook, Professor McGonagall blinked furiously and the\ntwinkling light that usually shone from Dumbledore’s eyes seemed\nto have gone out.\n‘Well,’ said Dumbledore finally, ‘that’s that. We’ve no business\nstaying here. We may as well go and join the celebrations.’\n‘Yeah,’ said Hagrid in a very muffled voice. ‘I’d best get\nthis bike away. G’night, Professor McGonagall – Professor\nDumbledore, sir.’\nWiping his streaming eyes on his jacket sleeve, Hagrid swung\nhimself on to the motorbike and kicked the engine into life; with\na roar it rose into the air and off into the night.\n‘I shall see you soon, I expect, Professor McGonagall,’ said\nDumbledore, nodding to her. Professor McGonagall blew her nose\nin reply.\nDumbledore turned and walked back down the street. On the\n18 HARRY POTTER\ncorner he stopped and took out the silver Put-Outer. He clicked it\nonce and twelve balls of light sped back to their street lamps so\nthat Privet Drive glowed suddenly orange and he could make out\na tabby cat slinking around the corner at the other end of the\nstreet. He could just see the bundle of blankets on the step of\nnumber four.\n‘Good luck, Harry,’ he murmured. He turned on his heel and\nwith a swish of his cloak he was gone.\nA breeze ruffled the neat hedges of Privet Drive, which lay\nsilent and tidy under the inky sky, the very last place you would\nexpect astonishing things to happen. Harry Potter rolled over\ninside his blankets without waking up. One small hand closed on\nthe letter beside him and he slept on, not knowing he was special,\nnot knowing he was famous, not knowing he would be woken in\na few hours’ time by Mrs Dursley’s scream as she opened the front\ndoor to put out the milk bottles, nor that he would spend the next\nfew weeks being prodded and pinched by his cousin Dudley ... He\ncouldn’t know that at this very moment, people meeting in secret\nall over the country were holding up their glasses and saying in\nhushed voices: ‘To Harry Potter – the boy who lived!’\n\n— CHAPTER TWO —\nThe Vanishing Glass\nNearly ten years had passed since the Dursleys had woken up to\nfind their nephew on the front step, but Privet Drive had hardly\nchanged at all. The sun rose on the same tidy front gardens and lit\nup the brass number four on the Dursleys’ front door; it crept into\ntheir living-room, which was almost exactly the same as it had\nbeen on the night when Mr Dursley had seen that fateful news\nreport about the owls. Only the photographs on the mantelpiece\nreally showed how much time had passed. Ten years ago, there\nhad been lots of pictures of what looked like a large pink beach\nball wearing different-coloured bobble hats – but Dudley Dursley\nwas no longer a baby, and now the photographs showed a large,\nblond boy riding his first bicycle, on a roundabout at the fair,\nplaying a computer game with his father, being hugged and kissed\nby his mother. The room held no sign at all that another boy lived\nin the house, too.\nYet Harry Potter was still there, asleep at the moment, but not\nfor long. His Aunt Petunia was awake and it was her shrill voice\nwhich made the first noise of the day.\n‘Up! Get up! Now!’\nHarry woke with a start. His aunt rapped on the door again.\n‘Up!’ she screeched. Harry heard her walking towards the\nkitchen and then the sound of the frying pan being put on the\ncooker. He rolled on to his back and tried to remember the dream\nhe had been having. It had been a good one. There had been a\nflying motorbike in it. He had a funny feeling he’d had the same\ndream before.\nHis aunt was back outside the door.\n‘Are you up yet?’ she demanded.\n‘Nearly,’ said Harry.\n‘Well, get a move on, I want you to look after the bacon. And\n20 HARRY POTTER\ndon’t you dare let it burn, I want everything perfect on Duddy’s\nbirthday.’\nHarry groaned.\n‘What did you say?’ his aunt snapped through the door.\n‘Nothing, nothing ...’\nDudley’s birthday – how could he have forgotten? Harry got\nslowly out of bed and started looking for socks. He found a pair\nunder his bed and, after pulling a spider off one of them, put them\non. Harry was used to spiders, because the cupboard under the\nstairs was full of them, and that was where he slept.\nWhen he was dressed he went down the hall into the kitchen.\nThe table was almost hidden beneath all Dudley’s birthday presents. It looked as though Dudley had got the new computer he\nwanted, not to mention the second television and the racing bike.\nExactly why Dudley wanted a racing bike was a mystery to Harry,\nas Dudley was very fat and hated exercise – unless of course it\ninvolved punching somebody. Dudley’s favourite punch-bag was\nHarry, but he couldn’t often catch him. Harry didn’t look it, but he\nwas very fast.\nPerhaps it had something to do with living in a dark cupboard,\nbut Harry had always been small and skinny for his age. He\nlooked even smaller and skinnier than he really was because all he\nhad to wear were old clothes of Dudley’s and Dudley was about\nfour times bigger than he was. Harry had a thin face, knobbly\nknees, black hair and bright-green eyes. He wore round glasses\nheld together with a lot of Sellotape because of all the times\nDudley had punched him on the nose. The only thing Harry liked\nabout his own appearance was a very thin scar on his forehead\nwhich was shaped like a bolt of lightning. He had had it as long as\nhe could remember and the first question he could ever remember\nasking his Aunt Petunia was how he had got it.\n‘In the car crash when your parents died,’ she had said. ‘And\ndon’t ask questions.’\nDon’t ask questions – that was the first rule for a quiet life with\nthe Dursleys.\nUncle Vernon entered the kitchen as Harry was turning over\nthe bacon.\n‘Comb your hair!’ he barked, by way of a morning greeting.\nAbout once a week, Uncle Vernon looked over the top of his\nnewspaper and shouted that Harry needed a haircut. Harry must\n THE VANISHING GLASS 21\nhave had more haircuts than the rest of the boys in his class put\ntogether, but it made no difference, his hair simply grew that way\n– all over the place.\nHarry was frying eggs by the time Dudley arrived in the kitchen\nwith his mother. Dudley looked a lot like Uncle Vernon. He had a\nlarge, pink face, not much neck, small, watery blue eyes and\nthick, blond hair that lay smoothly on his thick, fat head. Aunt\nPetunia often said that Dudley looked like a baby angel – Harry\noften said that Dudley looked like a pig in a wig.\nHarry put the plates of egg and bacon on the table, which was\ndifficult as there wasn’t much room. Dudley, meanwhile, was\ncounting his presents. His face fell.\n‘Thirty-six,’ he said, looking up at his mother and father. ‘That’s\ntwo less than last year.’\n‘Darling, you haven’t counted Auntie Marge’s present, see, it’s\nhere under this big one from Mummy and Daddy.’\n‘All right, thirty-seven then,’ said Dudley, going red in the face.\nHarry, who could see a huge Dudley tantrum coming on, began\nwolfing down his bacon as fast as possible in case Dudley turned\nthe table over.\nAunt Petunia obviously scented danger too, because she said\nquickly, ‘And we’ll buy you another two presents while we’re out\ntoday. How’s that, popkin? Two more presents. Is that all right?’\nDudley thought for a moment. It looked like hard work. Finally\nhe said slowly, ‘So I’ll have thirty ... thirty ...”\n‘Thirty-nine, sweetums,’ said Aunt Petunia.\n‘Oh.’ Dudley sat down heavily and grabbed the nearest parcel.\nAll right then.’\nUncle Vernon chuckled.\n‘Little tyke wants his money’s worth, just like his father. Atta\nboy, Dudley!’ He ruffled Dudley’s hair.\nAt that moment the telephone rang and Aunt Petunia went to\nanswer it while Harry and Uncle Vernon watched Dudley unwrap\nthe racing bike, a cine-camera, a remote-control aeroplane, sixteen\nnew computer games and a video recorder. He was ripping the\npaper off a gold wristwatch when Aunt Petunia came back from\nthe telephone, looking both angry and worried.\n‘Bad news, Vernon,’ she said. ‘Mrs Figg’s broken her leg. She\ncan’t take him.’ She jerked her head in Harry’s direction.\nDudley’s mouth fell open in horror but Harry’s heart gave a\n22 HARRY POTTER\nleap. Every year on Dudley’s birthday his parents took him and a\nfriend out for the day, to adventure parks, hamburger bars or the\ncinema. Every year, Harry was left behind with Mrs Figg, a mad\nold lady who lived two streets away. Harry hated it there. The\nwhole house smelled of cabbage and Mrs Figg made him look at\nphotographs of all the cats she’d ever owned.\n‘Now what?’ said Aunt Petunia, looking furiously at Harry as\nthough he’d planned this. Harry knew he ought to feel sorry that\nMrs Figg had broken her leg, but it wasn’t easy when he reminded\nhimself it would be a whole year before he had to look at Tibbies,\nSnowy, Mr Paws and Tufty again.\n‘We could phone Marge,’ Uncle Vernon suggested.\n‘Don’t be silly, Vernon, she hates the boy.’\nThe Dursleys often spoke about Harry like this, as though he\nwasn’t there – or rather, as though he was something very nasty\nthat couldn’t understand them, like a slug.\n‘What about what’s-her-name, your friend – Yvonne?’\n‘On holiday in Majorca,’ snapped Aunt Petunia.\n‘You could just leave me here,’ Harry put in hopefully (he’d be\nable to watch what he wanted on television for a change and\nmaybe even have a go on Dudley’s computer).\nAunt Petunia looked as though she’d just swallowed a lemon.\n‘And come back and find the house in ruins?’ she snarled.\n‘I won’t blow up the house,’ said Harry, but they weren’t listening.\n‘I suppose we could take him to the zoo,’ said Aunt Petunia\nslowly, ‘... and leave him in the car ...’\n‘That car’s new, he’s not sitting in it alone ...’\nDudley began to cry loudly. In fact, he wasn’t really crying, it\nhad been years since he’d really cried, but he knew that if he\nscrewed up his face and wailed, his mother would give him\nanything he wanted.\n‘Dinky Duddydums, don’t cry, Mummy won’t let him spoil your\nspecial day!’ she cried, flinging her arms around him.\n‘I ... don’t ... want ... him ... t-t-to come!’ Dudley yelled between\nhuge pretend sobs. ‘He always sp-spoils everything!’ He shot\nHarry a nasty grin through the gap in his mother’s arms.\nJust then, the doorbell rang – ‘Oh, Good Lord, they’re here!’\nsaid Aunt Petunia frantically – and a moment later, Dudley’s best\nfriend, Piers Polkiss, walked in with his mother. Piers was a\nscrawny boy with a face like a rat. He was usually the one who\n THE VANISHING GLASS 23\nheld people’s arms behind their backs while Dudley hit them.\nDudley stopped pretending to cry at once.\nHalf an hour later, Harry, who couldn’t believe his luck, was\nsitting in the back of the Dursleys’ car with Piers and Dudley, on\nthe way to the zoo for the first time in his life. His aunt and uncle\nhadn’t been able to think of anything else to do with him, but\nbefore they’d left, Uncle Vernon had taken Harry aside.\n‘I’m warning you,’ he had said, putting his large purple face\nright up close to Harry’s, ‘I’m warning you now, boy – any funny\nbusiness, anything at all – and you’ll be in that cupboard from\nnow until Christmas.’\n‘I’m not going to do anything,’ said Harry, ‘honestly ...’\nBut Uncle Vernon didn’t believe him. No one ever did.\nThe problem was, strange things often happened around Harry\nand it was just no good telling the Dursleys he didn’t make them\nhappen.\nOnce, Aunt Petunia, tired of Harry coming back from the barber’s looking as though he hadn’t been at all, had taken a pair of\nkitchen scissors and cut his hair so short he was almost bald\nexcept for his fringe, which she left ‘to hide that horrible scar’.\nDudley had laughed himself silly at Harry, who spent a sleepless\nnight imagining school the next day, where he was already\nlaughed at for his baggy clothes and Sellotaped glasses. Next\nmorning, however, he had got up to find his hair exactly as it had\nbeen before Aunt Petunia had sheared it off. He had been given a\nweek in his cupboard for this, even though he had tried to explain\nthat he couldn’t explain how it had grown back so quickly.\nAnother time, Aunt Petunia had been trying to force him into a\nrevolting old jumper of Dudley’s (brown with orange bobbles).\nThe harder she tried to pull it over his head, the smaller it seemed\nto become, until finally it might have fitted a glove puppet, but\ncertainly wouldn’t fit Harry. Aunt Petunia had decided it must\nhave shrunk in the wash and, to his great relief, Harry wasn’t\npunished.\nOn the other hand, he’d got into terrible trouble for being\nfound on the roof of the school kitchens. Dudley’s gang had been\nchasing him as usual when, as much to Harry’s surprise as anyone\nelse’s, there he was sitting on the chimney. The Dursleys had\nreceived a very angry letter from Harry’s headmistress telling them\nHarry had been climbing school buildings. But all he’d tried to do\n24 HARRY POTTER\n(as he shouted at Uncle Vernon through the locked door of his\ncupboard) was jump behind the big bins outside the kitchen\ndoors. Harry supposed that the wind must have caught him in\nmid-jump.\nBut today, nothing was going to go wrong. It was even worth\nbeing with Dudley and Piers to be spending the day somewhere\nthat wasn’t school, his cupboard or Mrs Figg’s cabbage-smelling\nliving-room.\nWhile he drove, Uncle Vernon complained to Aunt Petunia.\nHe liked to complain about things: people at work, Harry, the\ncouncil, Harry, the bank and Harry were just a few of his favourite\nsubjects. This morning, it was motorbikes.\n‘... roaring along like maniacs, the young hoodlums,’ he said,\nas a motorbike overtook them.\n‘I had a dream about a motorbike,’ said Harry, remembering\nsuddenly. ‘It was flying.’\nUncle Vernon nearly crashed into the car in front. He turned\nright around in his seat and yelled at Harry, his face like a gigantic\nbeetroot with a moustache, ‘MOTORBIKES DON’T FLY!’\nDudley and Piers sniggered.\n‘I know they don’t,’ said Harry. ‘It was only a dream.’\nBut he wished he hadn’t said anything. If there was one thing\nthe Dursleys hated even more than his asking questions, it was his\ntalking about anything acting in a way it shouldn’t, no matter if it\nwas in a dream or even a cartoon – they seemed to think he might\nget dangerous ideas.\nIt was a very sunny Saturday and the zoo was crowded with\nfamilies. The Dursleys bought Dudley and Piers large chocolate\nice-creams at the entrance and then, because the smiling lady in\nthe van had asked Harry what he wanted before they could hurry\nhim away, they bought him a cheap lemon ice lolly. It wasn’t bad\neither, Harry thought, licking it as they watched a gorilla scratching its head and looking remarkably like Dudley, except that it\nwasn’t blond.\nHarry had the best morning he’d had in a long time. He was\ncareful to walk a little way apart from the Dursleys so that Dudley\nand Piers, who were starting to get bored with the animals by\nlunch-time, wouldn’t fall back on their favourite hobby of hitting\nhim. They ate in the zoo restaurant and when Dudley had a\ntantrum because his knickerbocker glory wasn’t big enough,\n THE VANISHING GLASS 25\nUncle Vernon bought him another one and Harry was allowed to\nfinish the first.\nHarry felt, afterwards, that he should have known it was all too\ngood to last.\nAfter lunch they went to the reptile house. It was cool and dark\nin here, with lit windows all along the walls. Behind the glass, all\nsorts of lizards and snakes were crawling and slithering over bits\nof wood and stone. Dudley and Piers wanted to see huge, poisonous cobras and thick, man-crushing pythons. Dudley quickly\nfound the largest snake in the place. It could have wrapped its\nbody twice around Uncle Vernon’s car and crushed it into a dustbin – but at the moment it didn’t look in the mood. In fact, it was\nfast asleep.\nDudley stood with his nose pressed against the glass, staring at\nthe glistening brown coils.\n‘Make it move,’ he whined at his father. Uncle Vernon tapped\non the glass, but the snake didn’t budge.\n‘Do it again,’ Dudley ordered. Uncle Vernon rapped the glass\nsmartly with his knuckles, but the snake just snoozed on.\n‘This is boring,’ Dudley moaned. He shuffled away.\nHarry moved in front of the tank and looked intently at the\nsnake. He wouldn’t have been surprised if it had died of boredom\nitself – no company except stupid people drumming their fingers\non the glass trying to disturb it all day long. It was worse than\nhaving a cupboard as a bedroom, where the only visitor was Aunt\nPetunia hammering on the door to wake you up – at least he got to\nvisit the rest of the house.\nThe snake suddenly opened its beady eyes. Slowly, very slowly,\nit raised its head until its eyes were on a level with Harry’s.\nIt winked.\nHarry stared. Then he looked quickly around to see if anyone\nwas watching. They weren’t. He looked back at the snake and\nwinked, too.\nThe snake jerked its head towards Uncle Vernon and Dudley,\nthen raised its eyes to the ceiling. It gave Harry a look that said\nquite plainly: ‘I get that all the time.’\n‘I know,’ Harry murmured through the glass, though he wasn’t\nsure the snake could hear him. ‘It must be really annoying.’\nThe snake nodded vigorously.\n‘Where do you come from, anyway?’ Harry asked.\n26 HARRY POTTER\nThe snake jabbed its tail at a little sign next to the glass. Harry\npeered at it.\nBoa Constrictor, Brazil.\n‘Was it nice there?’\nThe boa constrictor jabbed its tail at the sign again and Harry\nread on: This specimen was bred in the zoo. ‘Oh, I see – so you’ve\nnever been to Brazil?’\nAs the snake shook its head, a deafening shout behind Harry\nmade both of them jump. ‘DUDLEY! MR DURSLEY! COME AND\nLOOK AT THIS SNAKE! YOU WON’T BELIEVE WHAT IT’S\nDOING!’\nDudley came waddling towards them as fast as he could.\n‘Out of the way, you,’ he said, punching Harry in the ribs.\nCaught by surprise, Harry fell hard on the concrete floor. What\ncame next happened so fast no one saw how it happened – one\nsecond, Piers and Dudley were leaning right up close to the glass,\nthe next, they had leapt back with howls of horror.\nHarry sat up and gasped; the glass front of the boa constrictor’s\ntank had vanished. The great snake was uncoiling itself rapidly,\nslithering out on to the floor – people throughout the reptile\nhouse screamed and started running for the exits.\nAs the snake slid swiftly past him, Harry could have sworn a\nlow, hissing voice said, ‘Brazil, here I come ... Thanksss, amigo.’\nThe keeper of the reptile house was in shock.\n‘But the glass,’ he kept saying, ‘where did the glass go?’\nThe zoo director himself made Aunt Petunia a cup of strong\nsweet tea while he apologised over and over again. Piers and\nDudley could only gibber. As far as Harry had seen, the snake\nhadn’t done anything except snap playfully at their heels as it\npassed, but by the time they were all back in Uncle Vernon’s car,\nDudley was telling them how it had nearly bitten off his leg, while\nPiers was swearing it had tried to squeeze him to death. But worst\nof all, for Harry at least, was Piers calming down enough to say,\n‘Harry was talking to it, weren’t you, Harry?’\nUncle Vernon waited until Piers was safely out of the house\nbefore starting on Harry. He was so angry he could hardly speak.\nHe managed to say, ‘Go – cupboard – stay – no meals,’ before he\ncollapsed into a chair and Aunt Petunia had to run and get him a\nlarge brandy.\n*\n THE VANISHING GLASS 27\nHarry lay in his dark cupboard much later, wishing he had a watch.\nHe didn’t know what time it was and he couldn’t be sure the\nDursleys were asleep yet. Until they were, he couldn’t risk sneaking\nto the kitchen for some food.\nHe’d lived with the Dursleys almost ten years, ten miserable\nyears, as long as he could remember, ever since he’d been a baby\nand his parents had died in that car crash. He couldn’t remember\nbeing in the car when his parents had died. Sometimes, when he\nstrained his memory during long hours in his cupboard, he came\nup with a strange vision: a blinding flash of green light and a\nburning pain on his forehead. This, he supposed, was the crash,\nthough he couldn’t imagine where all the green light came from.\nHe couldn’t remember his parents at all. His aunt and uncle never\nspoke about them, and of course he was forbidden to ask\nquestions. There were no photographs of them in the house.\nWhen he had been younger, Harry had dreamed and dreamed\nof some unknown relation coming to take him away, but it had\nnever happened; the Dursleys were his only family. Yet sometimes\nhe thought (or maybe hoped) that strangers in the street seemed\nto know him. Very strange strangers they were, too. A tiny man in\na violet top hat had bowed to him once while out shopping with\nAunt Petunia and Dudley. After asking Harry furiously if he knew\nthe man, Aunt Petunia had rushed them out of the shop without\nbuying anything. A wild-looking old woman dressed all in green\nhad waved merrily at him once on a bus. A bald man in a very\nlong purple coat had actually shaken his hand in the street the\nother day and then walked away without a word. The weirdest\nthing about all these people was the way they seemed to vanish\nthe second Harry tried to get a closer look.\nAt school, Harry had no one. Everybody knew that Dudley’s\ngang hated that odd Harry Potter in his baggy old clothes and\nbroken glasses, and nobody liked to disagree with Dudley’s gang.\n\n— CHAPTER THREE —\nThe Letters from No One\nThe escape of the Brazilian boa constrictor earned Harry his\nlongest-ever punishment. By the time he was allowed out of his\ncupboard again, the summer holidays had started and Dudley had\nalready broken his new cine-camera, crashed his remote-control\naeroplane and, first time on his racing bike, knocked down old\nMrs Figg as she crossed Privet Drive on her crutches.\nHarry was glad school was over, but there was no escaping\nDudley’s gang, who visited the house every single day. Piers,\nDennis, Malcolm and Gordon were all big and stupid, but as\nDudley was the biggest and stupidest of the lot, he was the leader.\nThe rest of them were all quite happy to join in Dudley’s favourite\nsport: Harry-hunting.\nThis was why Harry spent as much time as possible out of the\nhouse, wandering around and thinking about the end of the holidays, where he could see a tiny ray of hope. When September\ncame he would be going off to secondary school and, for the first\ntime in his life, he wouldn’t be with Dudley. Dudley had a place at\nUncle Vernon’s old school, Smeltings. Piers Polkiss was going\nthere, too. Harry, on the other hand, was going to Stonewall High,\nthe local comprehensive. Dudley thought this was very funny.\n‘They stuff people’s heads down the toilet first day at\nStonewall,’ he told Harry. ‘Want to come upstairs and practise?’\n‘No thanks,’ said Harry. ‘The poor toilet’s never had anything as\nhorrible as your head down it – it might be sick.’ Then he ran,\nbefore Dudley could work out what he’d said.\nOne day in July, Aunt Petunia took Dudley to London to buy\nhis Smeltings uniform, leaving Harry at Mrs Figg’s. Mrs Figg\nwasn’t as bad as usual. It turned out she’d broken her leg tripping\nover one of her cats and she didn’t seem quite as fond of them\nas before. She let Harry watch television and gave him a bit of\n THE LETTERS FROM NO ONE 29\nchocolate cake that tasted as though she’d had it for several years.\nThat evening, Dudley paraded around the living-room for the\nfamily in his brand-new uniform. Smeltings boys wore maroon\ntailcoats, orange knickerbockers and flat straw hats called boaters.\nThey also carried knobbly sticks, used for hitting each other while\nthe teachers weren’t looking. This was supposed to be good training\nfor later life.\nAs he looked at Dudley in his new knickerbockers, Uncle\nVernon said gruffly that it was the proudest moment of his life.\nAunt Petunia burst into tears and said she couldn’t believe it was\nher Ickle Dudleykins, he looked so handsome and grown-up.\nHarry didn’t trust himself to speak. He thought two of his ribs\nmight already have cracked from trying not to laugh.\nThere was a horrible smell in the kitchen next morning when\nHarry went in for breakfast. It seemed to be coming from a large\nmetal tub in the sink. He went to have a look. The tub was full of\nwhat looked like dirty rags swimming in grey water.\n‘What’s this?’ he asked Aunt Petunia. Her lips tightened as they\nalways did if he dared to ask a question.\n‘Your new school uniform,’ she said.\nHarry looked in the bowl again.\n‘Oh,’ he said. ‘I didn’t realise it had to be so wet.’\n‘Don’t be stupid,’ snapped Aunt Petunia. ‘I’m dyeing some of\nDudley’s old things grey for you. It’ll look just like everyone else’s\nwhen I’ve finished.’\nHarry seriously doubted this, but thought it best not to argue.\nHe sat down at the table and tried not to think about how he was\ngoing to look on his first day at Stonewall High – like he was\nwearing bits of old elephant skin, probably.\nDudley and Uncle Vernon came in, both with wrinkled noses\nbecause of the smell from Harry’s new uniform. Uncle Vernon\nopened his newspaper as usual and Dudley banged his Smeltings\nstick, which he carried everywhere, on the table.\nThey heard the click of the letter-box and flop of letters on the\ndoormat.\n‘Get the post, Dudley,’ said Uncle Vernon from behind his\npaper.\n‘Make Harry get it.’\n‘Get the post, Harry.’\n‘Make Dudley get it.’\n30 HARRY POTTER\n‘Poke him with your Smeltings stick, Dudley.’\nHarry dodged the Smeltings stick and went to get the post.\nThree things lay on the doormat: a postcard from Uncle Vernon’s\nsister Marge, who was holidaying on the Isle of Wight, a brown\nenvelope that looked like a bill and – a letter for Harry.\nHarry picked it up and stared at it, his heart twanging like a\ngiant elastic band. No one, ever, in his whole life, had written to\nhim. Who would? He had no friends, no other relatives – he\ndidn’t belong to the library so he’d never even got rude notes\nasking for books back. Yet here it was, a letter, addressed so\nplainly there could be no mistake:\nMr H. Potter\nThe Cupboard under the Stairs\n4 Privet Drive\nLittle Whinging\nSurrey\nThe envelope was thick and heavy, made of yellowish parchment,\nand the address was written in emerald-green ink. There was no\nstamp.\nTurning the envelope over, his hand trembling, Harry saw a\npurple wax seal bearing a coat of arms; a lion, an eagle, a badger\nand a snake surrounding a large letter ‘H’.\n‘Hurry up, boy!’ shouted Uncle Vernon from the kitchen. ‘What\nare you doing, checking for letter-bombs?’ He chuckled at his own\njoke.\nHarry went back to the kitchen, still staring at his letter. He\nhanded Uncle Vernon the bill and the postcard, sat down and\nslowly began to open the yellow envelope.\nUncle Vernon ripped open the bill, snorted in disgust and\nflipped over the postcard.\n‘Marge’s ill,’ he informed Aunt Petunia. ‘Ate a funny whelk ...’\n‘Dad!’ said Dudley suddenly. ‘Dad, Harry’s got something!’\nHarry was on the point of unfolding his letter, which was written on the same heavy parchment as the envelope, when it was\njerked sharply out of his hand by Uncle Vernon.\n‘That’s mine!’ said Harry, trying to snatch it back.\n‘Who’d be writing to you?’ sneered Uncle Vernon, shaking the\nletter open with one hand and glancing at it. His face went from\n THE LETTERS FROM NO ONE 31\nred to green faster than a set of traffic lights. And it didn’t stop\nthere. Within seconds it was the greyish white of old porridge.\n‘P-P-Petunia!’ he gasped.\nDudley tried to grab the letter to read it, but Uncle Vernon held\nit high out of his reach. Aunt Petunia took it curiously and read\nthe first line. For a moment it looked as though she might faint.\nShe clutched her throat and made a choking noise.\n‘Vernon! Oh my goodness – Vernon!’\nThey stared at each other, seeming to have forgotten that Harry\nand Dudley were still in the room. Dudley wasn’t used to being\nignored. He gave his father a sharp tap on the head with his\nSmeltings stick.\n‘I want to read that letter,’ he said loudly.\n‘I want to read it,’ said Harry furiously, ‘as it’s mine.’\n‘Get out, both of you,’ croaked Uncle Vernon, stuffing the letter\nback inside its envelope.\nHarry didn’t move.\n‘I WANT MY LETTER!’ he shouted.\n‘Let me see it!’ demanded Dudley.\n‘OUT!’ roared Uncle Vernon, and he took both Harry and\nDudley by the scruffs of their necks and threw them into the hall,\nslamming the kitchen door behind them. Harry and Dudley\npromptly had a furious but silent fight over who would listen at\nthe keyhole; Dudley won, so Harry, his glasses dangling from one\near, lay flat on his stomach to listen at the crack between door and\nfloor.\n‘Vernon,’ Aunt Petunia was saying in a quivering voice, ‘look at\nthe address – how could they possibly know where he sleeps? You\ndon’t think they’re watching the house?’\n‘Watching – spying – might be following us,’ muttered Uncle\nVernon wildly.\n‘But what should we do, Vernon? Should we write back? Tell\nthem we don’t want –’\nHarry could see Uncle Vernon’s shiny black shoes pacing up\nand down the kitchen.\n‘No,’ he said finally. ‘No, we’ll ignore it. If they don’t get an\nanswer ... yes, that’s best ... we won’t do anything ...’\n‘But –’\n‘I’m not having one in the house, Petunia! Didn’t we swear\nwhen we took him in we’d stamp out that dangerous nonsense?’\n32 HARRY POTTER\nThat evening when he got back from work, Uncle Vernon did\nsomething he’d never done before; he visited Harry in his cupboard.\n‘Where’s my letter?’ said Harry, the moment Uncle Vernon had\nsqueezed through the door. ‘Who’s writing to me?’\n‘No one. It was addressed to you by mistake,’ said Uncle\nVernon shortly. ‘I have burned it.’\n‘It was not a mistake,’ said Harry angrily. ‘It had my cupboard\non it.’\n‘SILENCE!’ yelled Uncle Vernon, and a couple of spiders fell\nfrom the ceiling. He took a few deep breaths and then forced his\nface into a smile, which looked quite painful.\n‘Er – yes, Harry – about this cupboard. Your aunt and I have\nbeen thinking ... you’re really getting a bit big for it ... we think it\nmight be nice if you moved into Dudley’s second bedroom.’\n‘Why?’ said Harry.\n‘Don’t ask questions!’ snapped his uncle. ‘Take this stuff\nupstairs, now.’\nThe Dursleys’ house had four bedrooms: one for Uncle Vernon\nand Aunt Petunia, one for visitors (usually Uncle Vernon’s sister,\nMarge), one where Dudley slept and one where Dudley kept all\nthe toys and things that wouldn’t fit into his first bedroom. It only\ntook Harry one trip upstairs to move everything he owned from\nthe cupboard to this room. He sat down on the bed and stared\naround him. Nearly everything in here was broken. The monthold cine-camera was lying on top of a small, working tank Dudley\nhad once driven over next door’s dog; in the corner was Dudley’s\nfirst-ever television set, which he’d put his foot through when his\nfavourite programme had been cancelled; there was a large birdcage which had once held a parrot that Dudley had swapped at\nschool for a real air-rifle, which was up on a shelf with the end all\nbent because Dudley had sat on it. Other shelves were full of\nbooks. They were the only things in the room that looked as\nthough they’d never been touched.\nFrom downstairs came the sound of Dudley bawling at his\nmother: ‘I don’t want him in there ... I need that room ... make him\nget out ...’\nHarry sighed and stretched out on the bed. Yesterday he’d have\ngiven anything to be up here. Today he’d rather be back in his\ncupboard with that letter than up here without it.\nNext morning at breakfast, everyone was rather quiet. Dudley was\n THE LETTERS FROM NO ONE 33\nin shock. He’d screamed, whacked his father with his Smeltings\nstick, been sick on purpose, kicked his mother and thrown his\ntortoise through the greenhouse roof and he still didn’t have his\nroom back. Harry was thinking about this time yesterday and\nbitterly wishing he’d opened the letter in the hall. Uncle Vernon\nand Aunt Petunia kept looking at each other darkly.\nWhen the post arrived, Uncle Vernon, who seemed to be trying\nto be nice to Harry, made Dudley go and get it. They heard him\nbanging things with his Smeltings stick all the way down the hall.\nThen he shouted, ‘There’s another one! Mr H. Potter, The Smallest\nBedroom, 4 Privet Drive –’\nWith a strangled cry, Uncle Vernon leapt from his seat and ran\ndown the hall, Harry right behind him. Uncle Vernon had to\nwrestle Dudley to the ground to get the letter from him, which\nwas made difficult by the fact that Harry had grabbed Uncle\nVernon around the neck from behind. After a minute of confused\nfighting, in which everyone got hit a lot by the Smeltings stick,\nUncle Vernon straightened up, gasping for breath, with Harry’s\nletter clutched in his hand.\n‘Go to your cupboard – I mean, your bedroom,’ he wheezed at\nHarry. ‘Dudley – go – just go.’\nHarry walked round and round his new room. Someone knew\nhe had moved out of his cupboard and they seemed to know he\nhadn’t received his first letter. Surely that meant they’d try again?\nAnd this time he’d make sure they didn’t fail. He had a plan.\n*\nThe repaired alarm clock rang at six o’clock the next morning.\nHarry turned it off quickly and dressed silently. He mustn’t wake\nthe Dursleys. He stole downstairs without turning on any of the\nlights.\nHe was going to wait for the postman on the corner of Privet\nDrive and get the letters for number four first. His heart hammered\nas he crept across the dark hall towards the front door –\n‘AAAAARRRGH!’\nHarry leapt into the air – he’d trodden on something big and\nsquashy on the doormat – something alive!\nLights clicked on upstairs and to his horror Harry realised that\nthe big squashy something had been his uncle’s face. Uncle\nVernon had been lying at the foot of the front door in a sleeping\nbag, clearly making sure that Harry didn’t do exactly what he’d\n34 HARRY POTTER\nbeen trying to do. He shouted at Harry for about half an hour and\nthen told him to go and make a cup of tea. Harry shuffled miserably off into the kitchen, and by the time he got back, the post\nhad arrived, right into Uncle Vernon’s lap. Harry could see three\nletters addressed in green ink.\n‘I want –’ he began, but Uncle Vernon was tearing the letters\ninto pieces before his eyes.\nUncle Vernon didn’t go to work that day. He stayed at home\nand nailed up the letter-box.\n‘See,’ he explained to Aunt Petunia through a mouthful of nails,\n‘if they can’t deliver them they’ll just give up.’\n‘I’m not sure that’ll work, Vernon.’\n‘Oh, these people’s minds work in strange ways, Petunia,\nthey’re not like you and me,’ said Uncle Vernon, trying to knock\nin a nail with the piece of fruit cake Aunt Petunia had just\nbrought him.\n*\nOn Friday, no fewer than twelve letters arrived for Harry. As they\ncouldn’t go through the letter-box they had been pushed under\nthe door, slotted through the sides and a few even forced through\nthe small window in the downstairs toilet.\nUncle Vernon stayed at home again. After burning all the letters,\nhe got out a hammer and nails and boarded up the cracks around\nthe front and back doors so no one could go out. He hummed\n‘Tiptoe through the Tulips’ as he worked, and jumped at small\nnoises.\n*\nOn Saturday, things began to get out of hand. Twenty-four letters\nto Harry found their way into the house, rolled up and hidden\ninside each of the two dozen eggs that their very confused milkman had handed Aunt Petunia through the living-room window.\nWhile Uncle Vernon made furious telephone calls to the post\noffice and the dairy trying to find someone to complain to, Aunt\nPetunia shredded the letters in her food mixer.\n‘Who on earth wants to talk to you this badly?’ Dudley asked\nHarry in amazement.\n*\nOn Sunday morning, Uncle Vernon sat down at the breakfast table\nlooking tired and rather ill, but happy.\n‘No post on Sundays,’ he reminded them happily as he spread\n THE LETTERS FROM NO ONE 35\nmarmalade on his newspapers, ‘no damn letters today –’\nSomething came whizzing down the kitchen chimney as he\nspoke and caught him sharply on the back of the head. Next\nmoment, thirty or forty letters came pelting out of the fireplace\nlike bullets. The Dursleys ducked, but Harry leapt into the air\ntrying to catch one –\n‘Out! OUT!’\nUncle Vernon seized Harry around the waist and threw him\ninto the hall. When Aunt Petunia and Dudley had run out with\ntheir arms over their faces, Uncle Vernon slammed the door shut.\nThey could hear the letters still streaming into the room,\nbouncing off the walls and floor.\n‘That does it,’ said Uncle Vernon, trying to speak calmly but\npulling great tufts out of his moustache at the same time. ‘I want\nyou all back here in five minutes, ready to leave. We’re going\naway. Just pack some clothes. No arguments!’\nHe looked so dangerous with half his moustache missing that\nno one dared argue. Ten minutes later they had wrenched their\nway through the boarded-up doors and were in the car, speeding\ntowards the motorway. Dudley was sniffling in the back seat;\nhis father had hit him round the head for holding them up while\nhe tried to pack his television, video and computer in his sports\nbag.\nThey drove. And they drove. Even Aunt Petunia didn’t dare ask\nwhere they were going. Every now and then Uncle Vernon would\ntake a sharp turning and drive in the opposite direction for a\nwhile.\n‘Shake ’em off ... shake ’em off,’ he would mutter whenever he\ndid this.\nThey didn’t stop to eat or drink all day. By nightfall Dudley was\nhowling. He’d never had such a bad day in his life. He was hungry,\nhe’d missed five television programmes he’d wanted to see and\nhe’d never gone so long without blowing up an alien on his\ncomputer.\nUncle Vernon stopped at last outside a gloomy-looking hotel\non the outskirts of a big city. Dudley and Harry shared a room\nwith twin beds and damp, musty sheets. Dudley snored but Harry\nstayed awake, sitting on the windowsill, staring down at the lights\nof passing cars and wondering ...\n*\n36 HARRY POTTER\nThey ate stale cornflakes and cold tinned tomatoes on toast for\nbreakfast next day. They had just finished when the owner of the\nhotel came over to their table.\n‘’Scuse me, but is one of you Mr H. Potter? Only I got about an\n’undred of these at the front desk.’\nShe held up a letter so they could read the green ink address:\nMr H. Potter\nRoom 17\nRailview Hotel\nCokeworth\nHarry made a grab for the letter but Uncle Vernon knocked his\nhand out of the way. The woman stared.\n‘I’ll take them,’ said Uncle Vernon, standing up quickly and\nfollowing her from the dining-room.\n*\n‘Wouldn’t it be better just to go home, dear?’ Aunt Petunia suggested timidly, hours later, but Uncle Vernon didn’t seem to hear\nher. Exactly what he was looking for, none of them knew. He\ndrove them into the middle of a forest, got out, looked around,\nshook his head, got back in the car and off they went again. The\nsame thing happened in the middle of a ploughed field, halfway\nacross a suspension bridge and at the top of a multi-storey car\npark.\n‘Daddy’s gone mad, hasn’t he?’ Dudley asked Aunt Petunia\ndully late that afternoon. Uncle Vernon had parked at the coast,\nlocked them all inside the car and disappeared.\nIt started to rain. Great drops beat on the roof of the car.\nDudley snivelled.\n‘It’s Monday,’ he told his mother. ‘The Great Humberto’s on\ntonight. I want to stay somewhere with a television.’\nMonday. This reminded Harry of something. If it was Monday –\nand you could usually count on Dudley to know the days of the\nweek, because of television – then tomorrow, Tuesday, was Harry’s\neleventh birthday. Of course, his birthdays were never exactly fun\n– last year, the Dursleys had given him a coat-hanger and a pair of\nUncle Vernon’s old socks. Still, you weren’t eleven every day.\nUncle Vernon was back and he was smiling. He was also carrying a long, thin package and didn’t answer Aunt Petunia when she\n THE LETTERS FROM NO ONE 37\nasked what he’d bought.\n‘Found the perfect place!’ he said. ‘Come on! Everyone out!’\nIt was very cold outside the car. Uncle Vernon was pointing at\nwhat looked like a large rock way out to sea. Perched on top of\nthe rock was the most miserable little shack you could imagine.\nOne thing was certain, there was no television in there.\n‘Storm forecast for tonight!’ said Uncle Vernon gleefully, clapping\nhis hands together. ‘And this gentleman’s kindly agreed to lend us\nhis boat!’\nA toothless old man came ambling up to them, pointing, with a\nrather wicked grin, at an old rowing boat bobbing in the iron-grey\nwater below them.\n‘I’ve already got us some rations,’ said Uncle Vernon, ‘so all\naboard!’\nIt was freezing in the boat. Icy sea spray and rain crept down\ntheir necks and a chilly wind whipped their faces. After what\nseemed like hours they reached the rock, where Uncle Vernon,\nslipping and sliding, led the way to the broken-down house.\nThe inside was horrible; it smelled strongly of seaweed, the\nwind whistled through the gaps in the wooden walls and the fireplace was damp and empty. There were only two rooms.\nUncle Vernon’s rations turned out to be a packet of crisps each\nand four bananas. He tried to start a fire but the empty crisp packets\njust smoked and shrivelled up.\n‘Could do with some of those letters now, eh?’ he said cheerfully.\nHe was in a very good mood. Obviously he thought nobody\nstood a chance of reaching them here in a storm to deliver post.\nHarry privately agreed, though the thought didn’t cheer him up at\nall.\nAs night fell, the promised storm blew up around them. Spray\nfrom the high waves splattered the walls of the hut and a fierce\nwind rattled the filthy windows. Aunt Petunia found a few\nmouldy blankets in the second room and made up a bed for\nDudley on the moth-eaten sofa. She and Uncle Vernon went off to\nthe lumpy bed next door and Harry was left to find the softest bit\nof floor he could and to curl up under the thinnest, most ragged\nblanket.\nThe storm raged more and more ferociously as the night went\non. Harry couldn’t sleep. He shivered and turned over, trying to\n38 HARRY POTTER\nget comfortable, his stomach rumbling with hunger. Dudley’s\nsnores were drowned by the low rolls of thunder that started near\nmidnight. The lighted dial of Dudley’s watch, which was dangling\nover the edge of the sofa on his fat wrist, told Harry he’d be eleven\nin ten minutes’ time. He lay and watched his birthday tick nearer,\nwondering if the Dursleys would remember at all, wondering\nwhere the letter-writer was now.\nFive minutes to go. Harry heard something creak outside. He\nhoped the roof wasn’t going to fall in, although he might be\nwarmer if it did. Four minutes to go. Maybe the house in Privet\nDrive would be so full of letters when they got back that he’d be\nable to steal one somehow.\nThree minutes to go. Was that the sea, slapping hard on the\nrock like that? And (two minutes to go) what was that funny\ncrunching noise? Was the rock crumbling into the sea?\nOne minute to go and he’d be eleven. Thirty seconds ... twenty\n... ten – nine – maybe he’d wake Dudley up, just to annoy him –\nthree – two – one –\nBOOM.\nThe whole shack shivered and Harry sat bolt upright, staring at\nthe door. Someone was outside, knocking to come in. ";
        }   

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            string text = TextBox.Text;
            string? selectedAlgorithmName = (AlgComboBox.SelectedItem as ComboBoxItem)?.Content.ToString();
            if (string.IsNullOrEmpty(selectedAlgorithmName)) return;
            
            ISortAlgorithm? selectedAlgorithm = null;
            switch (selectedAlgorithmName)
            {
                case "Сортировка слиянием (MergeSort)":
                {
                    selectedAlgorithm = new MergeSort();
                    selectedAlgorithmName = "merge";
                    break;
                }
                case "Поразрядная сортировка (RadixSort)":
                {
                    selectedAlgorithm = new RadixSort();
                    selectedAlgorithmName = "radix";
                    break;
                }
                
            }
            
            var sortProcessor = new TextProcessor(selectedAlgorithm);
            string[]? words = sortProcessor.SplitText(text);
            string[]? sorted = sortProcessor.SortWords(words);
            Dictionary<string, int> counts = sortProcessor.CountWords(sorted);

            Lbl.Text = $"Сортировка {selectedAlgorithmName} методом:\n";
            Lbl.Text += string.Join(", ", sorted) + "\n\n";
            Lbl.Text += "Подсчёт слов:\n";
            foreach (var pair in counts)
            {
                Lbl.Text += $"{pair.Key}: {pair.Value}\n";
            }
        }
    }
}
